stages:
  _check-env-decider:
    cmd: calkit check environment --name decider
    deps:
      - envs/calkit-environment.yml
    outs:
      - .calkit/env-locks/decider.yml:
          cache: false
          persist: true
    always_changed: true
    desc: Automatically generated by Calkit. Changes made here will be
      overwritten.
  _clean-nb-setup-sweep:
    cmd: calkit nb clean "modules/CEM/make_additional_tech_csv.ipynb"
    deps:
      - modules/CEM/make_additional_tech_csv.ipynb
    outs:
      - .calkit/notebooks/cleaned/modules/CEM/make_additional_tech_csv.ipynb:
          cache: false
    desc: Automatically generated from the 'setup-sweep' stage in 
      calkit.yaml. Changes made here will be overwritten.
  setup-sweep:
    cmd: calkit nb execute --environment decider --no-check --to html 
      "modules/CEM/make_additional_tech_csv.ipynb"
    deps:
      - .calkit/notebooks/cleaned/modules/CEM/make_additional_tech_csv.ipynb
      - modules/CEM/template/cost_mult_tech_map.yml
      - .calkit/env-locks/decider.yml
    outs:
      - modules/CEM/data_east/wave_profiles
      - modules/CEM/data_east/settings/settings_management.yml
      - modules/CEM/data_east/scenario_input.csv
      - modules/CEM/data_east/settings/cost_mult_tech_map_updated.yml
      - .calkit/notebooks/executed/modules/CEM/make_additional_tech_csv.ipynb:
          cache: false
      - .calkit/notebooks/html/modules/CEM/make_additional_tech_csv.html:
          cache: false
    desc: Automatically generated from the 'setup-sweep' stage in 
      calkit.yaml. Changes made here will be overwritten.
  _clean-nb-analyze-results:
    cmd: calkit nb clean "modules/CEM/analyze_results.ipynb"
    deps:
      - modules/CEM/analyze_results.ipynb
    outs:
      - .calkit/notebooks/cleaned/modules/CEM/analyze_results.ipynb:
          cache: false
    desc: Automatically generated from the 'analyze-results' stage in 
      calkit.yaml. Changes made here will be overwritten.
  analyze-results:
    cmd: calkit nb execute --environment decider --no-check --to html 
      "modules/CEM/analyze_results.ipynb"
    deps:
      - .calkit/notebooks/cleaned/modules/CEM/analyze_results.ipynb
      - modules/CEM/data_east/cases/Case_1/results/
      - modules/CEM/data_east/cases/Case_2/results/
      - modules/CEM/data_east/cases/Case_3/results/
      - modules/CEM/data_east/cases/Case_4/results/
      - modules/CEM/data_east/cases/Case_5/results/
      - modules/CEM/data_east/scenario_input.csv
      - .calkit/env-locks/decider.yml
    outs:
      - .calkit/notebooks/executed/modules/CEM/analyze_results.ipynb:
          cache: false
      - .calkit/notebooks/html/modules/CEM/analyze_results.html:
          cache: false
    desc: Automatically generated from the 'analyze-results' stage in 
      calkit.yaml. Changes made here will be overwritten.
  powergenome-data-download:
    cmd: bash modules/CEM/get-powergenome-data.sh
    deps:
      - modules/CEM/get-powergenome-data.sh
    outs:
      - modules/CEM/data/
      - modules/CEM/data_CA/test_misc_gen_inputs.csv
      - modules/CEM/data_CA/test_demand_segments_voll.csv
      - modules/CEM/data_east/Reserves.csv
      - modules/CEM/data_east/emission_policies.csv
      - modules/CEM/data_east/misc_gen_inputs.csv
      - modules/CEM/data_east/resource_capacity_spur.csv
      - modules/CEM/data_east/demand_segments_voll.csv
  powergenome-run:
    cmd: bash modules/CEM/run_powergenome.sh
    deps:
      - modules/CEM/run_powergenome.sh
      - modules/CEM/data/
      - modules/CEM/pg-data-env.yml
      - modules/CEM/data_CA/test_misc_gen_inputs.csv
      - modules/CEM/data_CA/test_demand_segments_voll.csv
      - modules/CEM/data_CA/settings/test_settings.yml
      # - modules/CEM/data_CA/test_scenario_input.csv
      - modules/CEM/data_east/Reserves.csv
      - modules/CEM/data_east/emission_policies.csv
      - modules/CEM/data_east/misc_gen_inputs.csv
      - modules/CEM/data_east/resource_capacity_spur.csv
      - modules/CEM/data_east/demand_segments_voll.csv
      - modules/CEM/data_east/settings/settings_management.yml
      - modules/CEM/data_east/settings/test_settings_2.yml
      - modules/CEM/data_east/scenario_input.csv
      - modules/CEM/data_east/wave_profiles/
      - modules/CEM/data_east/settings/cost_mult_tech_map_updated.yml
    outs:
      # - modules/CEM/data_CA/cases/Case_1/inputs
      # - modules/CEM/data_CA/cases/Case_2/inputs
      # - modules/CEM/data_CA/cases/Case_3/inputs
      # - modules/CEM/data_CA/cases/Case_4/inputs
      # - modules/CEM/data_CA/cases/Case_5/inputs
      - modules/CEM/data_east/cases/Case_1/inputs
      - modules/CEM/data_east/cases/Case_2/inputs
      - modules/CEM/data_east/cases/Case_3/inputs
      - modules/CEM/data_east/cases/Case_4/inputs
      - modules/CEM/data_east/cases/Case_5/inputs
  genx-run:
    cmd: julia --project=modules/CEM/ modules/CEM/Run.jl
    deps:
      - modules/CEM/Run.jl
      #- modules/CEM/juliapkg.json
      - modules/CEM/Project.toml
      # - modules/CEM/data_CA/cases/Case_1/inputs
      # - modules/CEM/data_CA/cases/Case_2/inputs
      # - modules/CEM/data_CA/cases/Case_3/inputs
      # - modules/CEM/data_CA/cases/Case_4/inputs
      # - modules/CEM/data_CA/cases/Case_5/inputs
      - modules/CEM/data_east/cases/Case_1/inputs
      - modules/CEM/data_east/cases/Case_2/inputs
      - modules/CEM/data_east/cases/Case_3/inputs
      - modules/CEM/data_east/cases/Case_4/inputs
      - modules/CEM/data_east/cases/Case_5/inputs
    outs:
      # - modules/CEM/data_CA/cases/Case_1/results/
      # - modules/CEM/data_CA/cases/Case_2/results/
      # - modules/CEM/data_CA/cases/Case_3/results/
      # - modules/CEM/data_CA/cases/Case_4/results/
      # - modules/CEM/data_CA/cases/Case_5/results/
      - modules/CEM/data_east/cases/Case_1/results/
      - modules/CEM/data_east/cases/Case_2/results/
      - modules/CEM/data_east/cases/Case_3/results/
      - modules/CEM/data_east/cases/Case_4/results/
      - modules/CEM/data_east/cases/Case_5/results/
